package top.lijngyuan.leetcode.äºŒåˆ†æŸ¥æ‰¾.hard;
//ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ•´æ•° m ï¼Œä½ éœ€è¦å°†è¿™ä¸ªæ•°ç»„åˆ†æˆ m ä¸ªéç©ºçš„è¿ç»­å­æ•°ç»„ã€‚
//
// è®¾è®¡ä¸€ä¸ªç®—æ³•ä½¿å¾—è¿™ m ä¸ªå­æ•°ç»„å„è‡ªå’Œçš„æœ€å¤§å€¼æœ€å°ã€‚
//
//
//
// ç¤ºä¾‹ 1ï¼š
//
//
//è¾“å…¥ï¼šnums = [7,2,5,10,8], m = 2
//è¾“å‡ºï¼š18
//è§£é‡Šï¼š
//ä¸€å…±æœ‰å››ç§æ–¹æ³•å°† nums åˆ†å‰²ä¸º 2 ä¸ªå­æ•°ç»„ã€‚ å…¶ä¸­æœ€å¥½çš„æ–¹å¼æ˜¯å°†å…¶åˆ†ä¸º [7,2,5] å’Œ [10,8] ã€‚
//å› ä¸ºæ­¤æ—¶è¿™ä¸¤ä¸ªå­æ•°ç»„å„è‡ªçš„å’Œçš„æœ€å¤§å€¼ä¸º18ï¼Œåœ¨æ‰€æœ‰æƒ…å†µä¸­æœ€å°ã€‚
//
// ç¤ºä¾‹ 2ï¼š
//
//
//è¾“å…¥ï¼šnums = [1,2,3,4,5], m = 2
//è¾“å‡ºï¼š9
//
//
// ç¤ºä¾‹ 3ï¼š
//
//
//è¾“å…¥ï¼šnums = [1,4,4], m = 3
//è¾“å‡ºï¼š4
//
//
//
//
// æç¤ºï¼š
//
//
// 1 <= nums.length <= 1000
// 0 <= nums[i] <= 106
// 1 <= m <= min(50, nums.length)
//
// Related Topics äºŒåˆ†æŸ¥æ‰¾ åŠ¨æ€è§„åˆ’
// ğŸ‘ 440 ğŸ‘ 0

/**
 * q410 solution
 *
 * @author <a href="kangjh@shukun.net">kangjinghang</a>
 * @date 2021-03-07
 * @since 1.0.0
 */
public class Q410Solution {

    public static void main(String[] args) {
        int[] nums = new int[]{7, 2, 5, 10, 8};
        System.out.println(splitArray(nums, 2));
        nums = new int[]{1, 2, 3, 4, 5};
        System.out.println(splitArray(nums, 2));
        nums = new int[]{1, 4, 4};
        System.out.println(splitArray(nums, 3));
    }

    public static int splitArray(int[] nums, int m) {
        int max = 0;
        int sum = 0;
        for (int num : nums) {
            max = Math.max(max, num);
            sum += num;
        }
        int low = max;
        int high = sum;
        while (low < high) {
            int mid = low + (high - low) / 2;
            int pieces = split(nums, mid);
            if (pieces > m) {
                // å¤šåˆ‡äº†å‡ åˆ€ï¼Œé‚£å°±å‘åç§»åŠ¨ä¸€ä¸‹ï¼Œå†æ‰¾æ‰¾æ¯”å®ƒå¤§çš„
                low = mid + 1;
            } else {
                // å¦åˆ™çš„è¯ï¼Œmidå¯èƒ½å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„å€¼ï¼Œæˆ–è€…æ¯”æˆ‘ä»¬æƒ³è¦çš„å€¼è¦å¤§ã€‚æ‰€ä»¥è¦æŠŠhighç½®æˆmidï¼Œå†å»æ–°çš„å¾ªç¯ï¼Œæ‰¾åˆ°çœŸæ­£çš„æ­£å¥½çš„æˆ‘ä»¬æƒ³è¦çš„å€¼
                high = mid;
            }
        }
        return low;
    }

    /**
     * è´ªå¿ƒåœ°æ¨¡æ‹Ÿåˆ†å‰²çš„è¿‡ç¨‹ï¼Œä»å‰åˆ°åéå†æ•°ç»„ï¼Œç”¨ sum è¡¨ç¤º"å½“å‰"åˆ†å‰²å­æ•°ç»„çš„å’Œï¼Œpieces è¡¨ç¤ºå·²ç»åˆ†å‰²å‡ºçš„å­æ•°ç»„çš„æ•°é‡ï¼ˆåŒ…æ‹¬å½“å‰å­æ•°ç»„ï¼‰ï¼Œ
     * ä¸€åˆ€ä¸€åˆ€çš„åˆ‡æ•°ç»„ã€‚è¿”å›çš„å°±æ˜¯æˆ‘ä»¬è¦æ»¡è¶³ä¸€ç§åˆ‡å‰²æ–¹æ¡ˆï¼Œè¿™ä¸ªæ–¹æ¡ˆæœ€å¤§åˆ†å‰²å­æ•°ç»„å’Œä¸è¶…è¿‡largestNumï¼Œè¿™æ—¶æˆ‘ä»¬æœ€å°‘èƒ½æœ‰å¤šå°‘ä¸ªå­æ•°ç»„
     */
    private static int split(int[] nums, int largestNum) {
        // æœ€å°‘çš„æƒ…å†µï¼Œå°±æ˜¯ä¸€åˆ€ä¹Ÿä¸åˆ‡ï¼Œè¿”å›1ä»½å­æ•°ç»„ï¼ˆå°±æ˜¯æœ¬èº«ï¼‰
        int pieces = 1;
        int sum = 0;
        for (int num : nums) {
            if (sum + num > largestNum) {
                // å½“ sum åŠ ä¸Šå½“å‰å€¼ num è¶…è¿‡äº† largestNumï¼Œæˆ‘ä»¬å°±æŠŠå½“å‰å–çš„å€¼ä½œä¸ºæ–°çš„ä¸€æ®µåˆ†å‰²å­æ•°ç»„çš„å¼€å¤´ï¼Œå¹¶å°† pieces åŠ  1
                // æˆ‘ä»¬å¿…é¡»åœ¨è¿™é‡Œåˆ‡ä¸Šä¸€åˆ€ï¼Œåˆ‡äº†è¿™ä¸€åˆ€ä»¥åï¼Œè¿™ä¸€åˆ€åé¢çš„æ–°çš„å­æ•°ç»„å°±è¦ä»å¤´å¼€å§‹åˆ¤æ–­sumï¼Œè¿™ä¸ª"å¤´"å°±æ˜¯å½“å‰å€¼ numï¼Œå› æ­¤ sum = num
                // æ€»ä¹‹å°±æ˜¯ï¼Œæ¯æ®µå­æ•°ç»„çš„æœ€å¤§å€¼ï¼Œéƒ½ä¸èƒ½è¶…è¿‡largestNumï¼Œè¶…è¿‡äº†å°±è¦åœ¨è¿™é‡Œåˆ‡ä¸Šä¸€åˆ€
                pieces++;
                sum = num;
            } else {
                sum += num;
            }
        }
        return pieces;
    }

}
