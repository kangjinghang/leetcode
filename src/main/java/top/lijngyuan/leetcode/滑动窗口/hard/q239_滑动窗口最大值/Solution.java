package top.lijngyuan.leetcode.æ»‘åŠ¨çª—å£.hard.q239_æ»‘åŠ¨çª—å£æœ€å¤§å€¼;
//ç»™å®šä¸€ä¸ªæ•°ç»„ numsï¼Œæœ‰ä¸€ä¸ªå¤§å°ä¸º k çš„æ»‘åŠ¨çª—å£ä»æ•°ç»„çš„æœ€å·¦ä¾§ç§»åŠ¨åˆ°æ•°ç»„çš„æœ€å³ä¾§ã€‚ä½ åªå¯ä»¥çœ‹åˆ°åœ¨æ»‘åŠ¨çª—å£å†…çš„ k ä¸ªæ•°å­—ã€‚æ»‘åŠ¨çª—å£æ¯æ¬¡åªå‘å³ç§»åŠ¨ä¸€ä½ã€‚
//
//
// è¿”å›æ»‘åŠ¨çª—å£ä¸­çš„æœ€å¤§å€¼ã€‚
//
//
//
// è¿›é˜¶ï¼š
//
// ä½ èƒ½åœ¨çº¿æ€§æ—¶é—´å¤æ‚åº¦å†…è§£å†³æ­¤é¢˜å—ï¼Ÿ
//
//
//
// ç¤ºä¾‹:
//
// è¾“å…¥: nums = [1,3,-1,-3,5,3,6,7], å’Œ k = 3
//è¾“å‡º: [3,3,5,5,6,7]
//è§£é‡Š:
//
//  æ»‘åŠ¨çª—å£çš„ä½ç½®                æœ€å¤§å€¼
//---------------               -----
//[1  3  -1] -3  5  3  6  7       3
// 1 [3  -1  -3] 5  3  6  7       3
// 1  3 [-1  -3  5] 3  6  7       5
// 1  3  -1 [-3  5  3] 6  7       5
// 1  3  -1  -3 [5  3  6] 7       6
// 1  3  -1  -3  5 [3  6  7]      7
//
//
//
// æç¤ºï¼š
//
//
// 1 <= nums.length <= 10^5
// -10^4 <= nums[i] <= 10^4
// 1 <= k <= nums.length
//
// Related Topics å † Sliding Window
// ğŸ‘ 619 ğŸ‘ 0

import java.util.ArrayDeque;
import java.util.Arrays;
import java.util.Deque;

/**
 * Solution
 *
 * @author <a href="kangjh@shukun.net">kangjinghang</a>
 * @date 2020-11-11
 * @since 1.0.0
 */
public class Solution {

    public static void main(String[] args) {
        int[] nums = new int[]{1, 3, -1, -3, 5, 3, 6, 7};
        System.out.println(Arrays.toString(maxSlidingWindow(nums, 3)));
    }

    /**
     * åŒå‘é˜Ÿåˆ—
     */
    public static int[] maxSlidingWindow(int[] nums, int k) {
        if (nums == null || nums.length == 0 || k == 0) {
            return new int[0];
        }
        if (nums.length == 1) {
            return nums;
        }

        int[] res = new int[nums.length - k + 1];
        int index = 0;
        // åŒç«¯é˜Ÿåˆ—ï¼Œå°±æ˜¯ä¸¤è¾¹éƒ½å¯ä»¥æ’å…¥å’Œåˆ é™¤æ•°æ®çš„é˜Ÿåˆ—ï¼Œæ³¨æ„è¿™é‡Œå­˜å‚¨çš„æ˜¯å…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡ï¼Œä¸æ˜¯å…ƒç´ çš„å€¼
        Deque<Integer> deque = new ArrayDeque<>();
        for (int i = 0; i < nums.length; i++) {
            // é¦–å…ˆæ¸…ç†é˜Ÿåˆ—
            // 1. åªä¿ç•™å½“å‰æ»‘åŠ¨çª—å£ä¸­æœ‰çš„å…ƒç´ çš„ç´¢å¼•
            // å¦‚æœé˜Ÿåˆ—ä¸­é˜Ÿå¤´å…ƒç´ å’Œå½“å‰å…ƒç´ ä½ç½®ç›¸å·®i-kï¼Œç›¸å½“äºé˜Ÿå¤´å…ƒç´ è¦å‡ºçª—å£äº†ï¼Œå°±æŠŠé˜Ÿå¤´å…ƒç´ ç»™ç§»é™¤ï¼Œæ³¨æ„é˜Ÿåˆ—ä¸­å­˜å‚¨
            // çš„æ˜¯å…ƒç´ çš„ä¸‹æ ‡ï¼ˆå‡½æ•°peekFirst()è¡¨ç¤ºçš„æ˜¯è·å–é˜Ÿå¤´çš„ä¸‹æ ‡ï¼Œå‡½æ•°pollFirst()è¡¨ç¤ºçš„æ˜¯ç§»é™¤é˜Ÿå¤´å…ƒç´ çš„ä¸‹æ ‡ï¼‰
            if (!deque.isEmpty() && deque.peekFirst() <= i - k) {
                deque.pollFirst();
            }
            // 2. ç§»é™¤æ¯”å½“å‰å…ƒç´ å°çš„æ‰€æœ‰å…ƒç´ ï¼Œå®ƒä»¬ä¸å¯èƒ½æ˜¯æœ€å¤§çš„
            // åœ¨æ·»åŠ ä¸€ä¸ªå€¼ä¹‹å‰ï¼Œå‰é¢æ¯”ä»–å°çš„éƒ½è¦è¢«ç§»é™¤æ‰ï¼Œå¹¶ä¸”è¿˜è¦ä¿è¯çª—å£ä¸­é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ æ°¸è¿œæ˜¯é˜Ÿåˆ—ä¸­æœ€å¤§çš„
            while (!deque.isEmpty() && nums[deque.peekLast()] < nums[i]) {
                deque.pollLast();
            }
            // å½“å‰å…ƒç´ çš„ä¸‹æ ‡åŠ å…¥åˆ°é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œå³å°†å½“å‰å…ƒç´ æ·»åŠ åˆ°åŒå‘é˜Ÿåˆ—ä¸­
            deque.addLast(i);
            // å½“çª—å£çš„é•¿åº¦å¤§äºç­‰äºkä¸ªçš„æ—¶å€™æ‰å¼€å§‹è®¡ç®—ï¼ˆæ³¨æ„è¿™é‡Œçš„iæ˜¯ä»0å¼€å§‹çš„ï¼‰,åˆšå¼€å§‹çª—å£è¿˜æ¯”è¾ƒå°ï¼Œä¸ç”¨åŠ å…¥ç»“æœé›†
            if (i >= k - 1) {
                // é˜Ÿå¤´å…ƒç´ æ˜¯é˜Ÿåˆ—ä¸­æœ€å¤§çš„ï¼ŒæŠŠé˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´ åŠ å…¥åˆ°æ•°ç»„ä¸­
                res[index++] = nums[deque.peekFirst()];
            }
        }
        return res;
    }

    /**
     * æš´åŠ›è§£æ³•
     */
    public static int[] maxSlidingWindow1(int[] nums, int k) {
        // L-k+1 ä¸ªçª—å£
        int[] arr = new int[nums.length - k + 1];
        for (int i = 0; i < arr.length; i++) {
            int max = nums[i];
            for (int j = i + 1; j < i + k; j++) {
                if (max < nums[j]) {
                    max = nums[j];
                }
            }
            arr[i] = max;
        }
        return arr;
    }

}
